<!DOCTYPE html>
<html>
<meta charset="utf-8">

<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<body style="margin: 0 auto; background: #f3f2f2;">
    <div id="fb-root"></div>
     <script>(function(d, s, id) {
          var js, fjs = d.getElementsByTagName(s)[0];
          if (d.getElementById(id)) return;
          js = d.createElement(s); js.id = id;
          js.src = 'https://connect.facebook.net/vi_VN/sdk.js#xfbml=1&version=v2.12&appId=318405871917318&autoLogAppEvents=1';
          fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>

    <div class="row" style="margin: 0px 0px 10px;">
        <div class="col-md-12" style="text-align: center; background: #337ab7; color: #f3f2f2;">
                <img width="100px" style="margin-top: 10px;" src="./logo.png">
                <h2>CÔNG CỤ KHỞI TẠO CODE ĐĂNG KÝ HỌC PHẦN - B3BIESEC</h2>
        </div>
    </div>
    <div ng-app="myAppIUH" ng-controller="myCtrl" class="row" style="width: 100%;margin: 0 auto;">
        <div class="col-md-8">

            <div class="col-md-12">
				<div class="panel panel-primary">
					<div class="panel-heading" style="text-align: center;">Đăng Ký Lớp Học Phần Theo Mã Lớp Học Phần</div>
					<div class="form-group panel-body">
						<label>Mã Lớp Học Phần:</label>
                        <input  class="form-control"  ng-model="maLopHocPhan">
                        <label>Nhóm:</label>
						<input type="number" min="1" max="5" class="form-control" ng-model="nhom">
						<button class="btn btn-primary" style="margin:10px 0;" data-toggle="collapse" data-target="#codeDangKyLopHP" ng-click="generationCodeRegisterClass()">Khởi Tạo</button>
						<div id="codeDangKyLopHP" class="collapse" class="col-md-12">
							<textarea class="form-control"  style="width: 100%;" cols="50">{{codeGenerationCodeRegisterClass}}</textarea>
						</div>
					</div>
				</div>
            </div>   

            <div class="col-md-12" >
				<div class="panel panel-primary">
					<div class="panel-heading" style="text-align: center;"> Sinh Code Load Lớp Học Phần Theo Mã Học Phần</div>
				   <div class="form-group panel-body">
						<label>Mã Học Phần:</label>
						<input class="form-control"  ng-model="maHocPhan">
						<button class="btn btn-primary"  style="margin:10px 0;"  data-toggle="collapse" data-target="#codeLoadLop" ng-click="generationCodeLoadClass()">Khởi Tạo</button>
						<div id="codeLoadLop" class="collapse" class="col-md-12">
							<textarea class="form-control" style="width: 100%;" cols="50">{{codeGenerationCodeLoadClass}}</textarea>
						</div>
					</div>
				</div>
            </div>

            <style>
                .fb-comments span{
                    width: 100% !important;
                }
                .fb-comments span iframe{
                    width: 100% !important;
                }
            </style>
            <div class="fb-comments col-md-12" data-href="https://www.facebook.com/tanphongtcd" data-numposts="100"></div>      
        </div>
        
        <div class="col-md-4">
			<div class="panel panel-primary">
				<div class="panel-heading" style="text-align: center;">Hướng Dẫn</div>
				<div class="panel-body">
                        <div class="panel-body">
                                <p style="color: red;text-align: center;font-weight: bold;">🕵 Đăng ký lớp Học Phần Siêu Nhanh</p>
                                <p>Mục đích: Hỗ trợ đăng ký nhanh theo mã lớp học phần khi chỉ cần biết mã học phần.</p>
                                <p>💞 Bước 1: Đăng nhập trang <a href="http://www.iuh.edu.vn/phongdaotao/Login.aspx.">Đăng Ký Học Phần</a></p>
								<p>💞 Bước 2: Di chuyển vào trang <a href="http://www.iuh.edu.vn/phongdaotao/DanhSachLopHocPhan.aspx">Xem Lớp Học Phần</a> để lấy Mã Học Phần</p>
                                <p>💞 Bước 3: Nhập mã lớp học phần. và nhóm thực hành với lớp học phần có thực hành</p>
                                <p>💞 Chú ý: Với Lớp Học Phần có nhóm thì nhập nhóm hoặc để trống</p>
                                <p>💞 Bước 4: Nhấn button <strong style="color:blue">Khởi Tạo</strong>.</p>
                                <p>💞 Bước 5: <strong style="color:blue">Copy đoạn mã code</strong> như hình phía dưới.</p>
                                <p>💞 Bước 6: Truy cập trang <a href="http://www.iuh.edu.vn/phongdaotao/DangKyHP.aspx">Đăng Ký Học Phần</a> và nhấn tổ hợp phím <strong style="color:blue">Ctrl+Shift+J</strong> để đến giao diện console.</p>
                                <p>💞 Bước 7: Tại đây Copy đoạn mã phia trên <strong style="color:blue">paste vào khung console</strong> như hình dưới.</p>
                                <p>💞 Bước 8: Enter và chờ kết quả.</p>
                                <p style="color:red;text-align:  center;font-weight:  bold;">🕵 Khởi tạo code Load Lớp Học Phần Siêu Nhanh</p>
                                <p>Mục đích: Giúp load nhanh các lớp học phần trong khung đăng ký từ mã học phần có sẵn. Chức năng này giúp sinh viên dễ dàng kiểm tra được lớp học phần</p>
                                <p>Điểm hay của chức năng này giúp cho sinh viên khi đã đăng ký học phần A nhưng vẫn có thể load lại lớp học phần A để kiểm tra các lớp trống hoặc tình trạng sinh viên của lớp. Để biết mà bay nhảy khi lớp chưa đủ sinh viên</p>
                                <p>💞 Tương tự như trên, nhưng thay vì nhập Mã Lớp Học Phần thì nhập Mã Học Phần</p>
                                <p style="color:red;text-align:  center;font-weight:  bold;"> 👨‍👨‍👦 Mã nguồn và phát triển  👨‍👨‍👧‍👧</p>
                                <p>Bộ công cụ phát sinh mã đăng ký học phần được phát triển bởi team B3bieSec thuộc club An Toàn Thông Tin - IUH.</p>
                                <p>Mã nguồn và tài liệu được công khai đến cộng đồng sinh viên thành mã nguồn mở tại địa chỉ github <a href="https://github.com/phongptn93/iuher-trick">here</a></p>
                                <p>Mục đích của bộ tool giúp tối ưu hóa tốc độ load và tránh tải dữ liệu từ server quá nhiều, Công cụ có khả năng giảm đáng để thời gian load học phần và đăng ký.</p>
                                <p>Mọi đóng góp có thể liên hệ team tại địa chỉ: <a href="https://www.facebook.com/tanphongtcd">Fb Aki</a></p>
                                <p>👮 Kế hoặc phát triển: </p>
                                <p> 🖖 Kiểm tra tình trạng lớp học phần hiện tại nhanh chóng</p>
                                <p> 🖖 .... </p> 
                                <p style="color:red;text-align:  center;font-weight:  bold;"> 👨‍👨‍👦 Thành Viên Hỗ Trợ 👨‍👨‍👧‍👧</p>
                                <p>👉 Vũ An Khang - FB </p>
                                <p>👉 Lưu Gia Đức - FB </p>
                                <p>👉 Phạm Văn Duẫn - FB </p>
                                <p>👉 Dương Thế Tài - FB</p>
                                <p style="color:red;text-align:  center;font-weight:  bold;"> 👨‍👨‍👦 Cộng Đồng IT-IUH 👨‍👨‍👧‍👧</p>
                                <p>😎 https://fb.com/ITHumans/</p> 
                                <p>😎 https://fb.com/groups/cntt.iuh/</p> 
								<p>Ngoài ra cũng xin cảm ơn đến một số thành viên cũng như những người bạn đã góp ý hỗ trợ để bộ công cụ đơn giản nhất có thể</p>
                            </div>
				</div>
            </div>
        </div>

    </div>

    <script>
    var app = angular.module('myAppIUH', []);
    app.controller('myCtrl', function($scope) {
        $scope.maHocPhan = "";
        $scope.maLopHocPhan = "";
        $scope.codeGenerationCodeRegisterClass  = "";
        $scope.generationCodeLoadClass = function(){
            var str = "GirdDangKyHocPhanDeleteAllRow('tblLopHocPhanChuaDangKy');";
                str = "var namHoc = 2018; var nienHoc= namHoc+' - '+ (namHoc + 1); var hocKy='1'; var trangThai = '1';";
                str += "var MaHocPhan = '" + $scope.maHocPhan + "';";
                str += "document.getElementById('ctl00_MainContent_hddNienHoc').value = namHoc;";
                str += "document.getElementById('ctl00_MainContent_txtNienHoc').value = nienHoc;";
                str += "document.getElementById('ctl00_MainContent_txtHocKy').value = hocKy;";
                str += "document.getElementsByName('LoaiDangKy')[trangThai-1].checked = true;";
                str += "LoadLopHocPhan_asynchr(AjaxDangKyHocPhan.GetLopHocPhan(MaHocPhan , ' ', namHoc, hocKy, trangThai));";
                $scope.codeGenerationCodeLoadClass = str;
        };

        $scope.generationCodeRegisterClass = function(){

            /*var request = new XMLHttpRequest;
            request.open('POST', 'http://www.iuh.edu.vn/Phongdaotao/ajaxpro/DangKyHP,App_Web_3fhy23r3.ashx', true);
            request.setRequestHeader('Content-type', 'text/plain; charset=utf-8');
			request.setRequestHeader('X-AjaxPro-Method', 'GetLopHocPhan');
            request.send(JSON.stringify({MaHocPhan: $scope.maLopHocPhan.substring(0, $scope.maLopHocPhan.length - 2) , MonTuongDuong: ' ', NamHoc: namHoc, HocKy: hocKy, TrangThaiDangKy: trangThai})) // Make sure to stringify
            request.onload = function() {
                // Do whatever with response
                var data = request.responseText;
                data = data.replace('new Ajax.Web.DataSet(','').replace('new Ajax.Web.DataTable(','').replace(')','').replace(')','').replace(';/*','');
                var json = JSON.parse(data);
                var maID = '';
                for(var i = 0;i< a["Result"][1].length; i++)
                {
                    if(a["Result"][1][i][2] === MaLopHocPhan)
                    {
                        maID = a["Result"][1][i][0];
                        break;
                    }
                }

            }*/

                //Register
              
                var str = "var namHoc = 2018; var hocKy='1'; var trangThai = '1';";
                str += "var maLopHocPhan = '" + $scope.maLopHocPhan + "';";
                str += "var maHocPhan = maLopHocPhan.substring(0, maLopHocPhan.length - 2);";
                str += "var nhom = '" + ($scope.nhom <= 1 ? 1 : $scope.nhom)  +"';";
                str += "var json = AjaxDangKyHocPhan.GetLopHocPhan(maHocPhan, ' ', namHoc, hocKy, trangThai);";
                str += "var data = json.value.Result.Tables[0].Rows;";
                str += "var IDLopHocPhan = 0;";
                str += "for(var i = 0;i< data.length;i++)";
                str += "{";
                str += "if(data[i]['LopHocPhan'] == maLopHocPhan){";
                str += "        IDLopHocPhan = data[i]['IDLopHocPhan'];";
                str += "        break;";
                str += "    }";
                str += "}";
                str += "var res = AjaxDangKyHocPhan.DangKy(IDLopHocPhan, trangThai, '-1', namHoc, '3', maHocPhan, ' ', nhom).value;";
                str += "alert(res.Message);";
                
                $scope.codeGenerationCodeRegisterClass = str;
                console.log($scope.codeGenerationCodeRegisterClass);
            };

    });
    </script>

</body>
</html>
